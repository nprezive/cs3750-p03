<html>
	<head>
		<title>Home Page</title>
		<script type = "text/javascript">
			var canavs;
			var ctx; //canvas context
			var canvasWidth;
			var canvasHeight;
			var rows = 50;//should probably be set by server
			var cols = 100;//should probably be set by server
			var gameButtons; //2d array for game buttons
			var tileWidth;
			var tileHeight;	

			function initGame(){
				//set global variabls, and draw game. Cannot b
				//be called before page loaded
				canvas = document.getElementById('gameCanvas');
				ctx = canvas.getContext("2d");
				canvas.addEventListener('click',function(e){
					tileClick(e.clientX - canvas.offsetLeft,e.clientY - canvas.offsetTop);	
					//alert("X: " + e.clientX + " Y: " + e.clientY);
				});
				//ctx.fillRect(100,0,150,150);
				ctx.fillStyle = "#aabbee";
				canvasWidth = canvas.width;
				canvasHeight = canvas.height;
				tileWidth = canvasWidth / cols;
				tileHeight = canvasHeight / rows;
				gameButtons = [];
				for(var r = 0; r < rows; r++){
					gameButtons[r] = [];
					for(var c = 0; c < cols; c++){
						gameButtons[r][c] = {xPos:c*tileWidth,yPos:r * tileHeight,toggled:false};
						if(gameButtons[r][c].toggled == false)
							ctx.fillStyle = "#ff0000";
						else
							ctx.fillStyle = "#0000ff";
						ctx.fillRect(c * tileWidth,r * tileHeight,tileWidth * .9,tileHeight * .9);
					}
				}
			}
			function tileClick(xClick,yClick){
				for(var r = 0; r < rows; r++){
					if(yClick > gameButtons[r][0].yPos){
						if(yClick < gameButtons[r+1][0].yPos){//clicked the currentRow
							for(var c = 0; c < cols; c++){
								if(xClick > gameButtons[r][c].xPos){
									if(xClick < gameButtons[r][c+1].xPos){
										gameButtons[r][c].toggled = !gameButtons[r][c].toggled;
									}
								}
							}
						}
					}
				}
				drawGrid();
			}
			function drawGrid(){
				for(var r = 0; r < rows; r++){
					for(var c = 0; c < cols; c++){
						if(gameButtons[r][c].toggled == false)
							ctx.fillStyle = "#ff0000";
						else
							ctx.fillStyle = "#0000ff";
						ctx.fillRect(c * tileWidth,r * tileHeight,tileWidth * .9,tileHeight * .9);
					}
				}

			}
		</script>
	</head>
	<body>
		<canvas id = "gameCanvas" width = "1600" height = "800"></canvas>
		<input type = "Button" onclick = "initGame()" value = "start"/>
	</body>
</html>
